version: 0.1.{build}
os: Visual Studio 2015
configuration: Release
cache:
 - 'packages -> **\packages.config'

before_build:
  - nuget restore

build_script:
- cmd: '"%ProgramFiles(x86)%\MSBuild\14.0\Bin\MSBuild.exe" /nologo /m /v:m /nr:false /flp:verbosity=detailed'

artifacts:
 - path: src\PowerBuild.NuGet\bin\$(configuration)\*.nupkg
   name: Packages
 - path: src\PowerBuild\bin\$(configuration)
   name: Binaries

deploy:
- provider: GitHub
  tag: v$(appveyor_build_version)
  release: PowerBuild v$(appveyor_build_version)
  auth_token:
    secure: SZBNXkG0/lQEfOixUOzPARVZi3pOzDFXoNYxdxic0QfU9kd9eMo6J4xQCp2a3zHz
  artifact: Binaries,Packages
  draft: true
  prerelease: false
  on:
    branch: master                 # release from master branch only